# ç¬¬ 2 ç« ï¼šäº¤äº’å¼ç¸®æ”¾çš„å¥§ç§˜ - ç¨‹å¼ç¢¼ç¯„ä¾‹

> æœ¬ç›®éŒ„åŒ…å«ã€Šæ·±åº¦ç ”ç©¶ä»£ç†äººå¯¦æˆ°ã€‹ç¬¬ 2 ç« çš„å®Œæ•´å¯é‹è¡Œç¨‹å¼ç¢¼ã€‚

---

## å¿«é€Ÿé–‹å§‹

### 1. å»ºç«‹è™›æ“¬ç’°å¢ƒ

```bash
cd code-examples/chapter-02
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

### 2. å®‰è£ä¾è³´

```bash
pip install -r requirements.txt
```

### 3. è¨­å®šç’°å¢ƒè®Šæ•¸

```bash
cp .env.example .env
# ç·¨è¼¯ .env æª”æ¡ˆï¼Œå¡«å…¥ä½ çš„ API Key
```

### 4. åŸ·è¡Œå¯¦é©—

```bash
# åŸ·è¡Œå®Œæ•´ç¸®æ”¾å¯¦é©—
python scaling_experiment.py

# æŒ‡å®šç‰¹å®šé…ç½®
python scaling_experiment.py --config small-many
python scaling_experiment.py --config large-few

# ç”Ÿæˆå ±å‘Š
python scaling_experiment.py --report
```

---

## æª”æ¡ˆèªªæ˜

| æª”æ¡ˆ | èªªæ˜ |
|------|------|
| `scaling_experiment.py` | å®Œæ•´çš„ç¸®æ”¾å¯¦é©—æ¡†æ¶ï¼ˆ~400 è¡Œï¼‰ |
| `requirements.txt` | Python ä¾è³´æ¸…å–® |
| `.env.example` | ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹ |
| `README.md` | æœ¬æ–‡ä»¶ |

---

## æ ¸å¿ƒæ¦‚å¿µ

### äº¤äº’å¼ç¸®æ”¾å…¬å¼

```
æ€§èƒ½ = f(æ¨¡å‹å®¹é‡, è³‡æ–™å“è³ª, äº¤äº’æ·±åº¦)
```

æœ¬ç« å¯¦é©—é©—è­‰äº†ã€Œç¬¬ä¸‰ç¶­åº¦ç¸®æ”¾ã€çš„æ ¸å¿ƒå‡è¨­ï¼š**é€éå¢åŠ äº¤äº’æ·±åº¦ï¼Œå°æ¨¡å‹å¯ä»¥é”åˆ°æˆ–è¶…è¶Šå¤§æ¨¡å‹çš„è¡¨ç¾**ã€‚

### å¯¦é©—é…ç½®

```python
from scaling_experiment import ExperimentConfig, ScalingExperiment

# é…ç½® Aï¼šå°æ¨¡å‹ + å¤šäº¤äº’
config_a = ExperimentConfig(
    name="small-many",
    model="gpt-4o-mini",
    max_interactions=20,
    temperature=0.1
)

# é…ç½® Bï¼šå¤§æ¨¡å‹ + å°‘äº¤äº’
config_b = ExperimentConfig(
    name="large-few",
    model="gpt-4o",
    max_interactions=5,
    temperature=0.1
)

# åŸ·è¡Œå¯¦é©—
experiment = ScalingExperiment(tasks=my_tasks)
results = experiment.run_all([config_a, config_b])
```

---

## å¯¦é©—ä»»å‹™ç¯„ä¾‹

å¯¦é©—æ¡†æ¶å…§å»ºä»¥ä¸‹ä»»å‹™é¡å‹ï¼š

### 1. äº‹å¯¦æŸ¥è©¢
```python
Task(
    id="fact_01",
    question="2024 å¹´è«¾è²çˆ¾ç‰©ç†å­¸çå¾—ä¸»æ˜¯èª°ï¼Ÿä»–å€‘çš„ä¸»è¦è²¢ç»æ˜¯ä»€éº¼ï¼Ÿ",
    difficulty="medium",
    expected_facts=["Hopfield", "Hinton", "ç¥ç¶“ç¶²è·¯", "æ©Ÿå™¨å­¸ç¿’"]
)
```

### 2. æ¯”è¼ƒåˆ†æ
```python
Task(
    id="compare_01",
    question="æ¯”è¼ƒ Transformer å’Œ Mamba æ¶æ§‹çš„å„ªç¼ºé»",
    difficulty="hard",
    expected_facts=["è‡ªæ³¨æ„åŠ›", "ç‹€æ…‹ç©ºé–“", "è¨ˆç®—è¤‡é›œåº¦", "é•·ç¨‹ä¾è³´"]
)
```

### 3. æ™‚äº‹ç ”ç©¶
```python
Task(
    id="current_01",
    question="OpenAI æœ€è¿‘çš„ o1 æ¨¡å‹æœ‰ä»€éº¼ç‰¹åˆ¥ä¹‹è™•ï¼Ÿ",
    difficulty="medium",
    expected_facts=["æ¨ç†", "æ€ç¶­éˆ", "æ¸¬è©¦æ™‚è¨ˆç®—"]
)
```

---

## åŸ·è¡Œç¯„ä¾‹

```
============================================================
ğŸ§ª äº¤äº’å¼ç¸®æ”¾å¯¦é©—
============================================================
ğŸ“Š å¯¦é©—é…ç½®: 2 å€‹
ğŸ“ ä»»å‹™æ•¸é‡: 5 å€‹

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ é…ç½®: small-many
   æ¨¡å‹: gpt-4o-mini
   æœ€å¤§äº¤äº’: 20 æ¬¡

   ğŸ”„ ä»»å‹™ 1/5: 2024 å¹´è«¾è²çˆ¾ç‰©ç†å­¸çå¾—ä¸»...
      äº¤äº’æ¬¡æ•¸: 8
      äº‹å¯¦è¦†è“‹ç‡: 100%
      è€—æ™‚: 15.2s
      âœ… æˆåŠŸ

   ğŸ”„ ä»»å‹™ 2/5: æ¯”è¼ƒ Transformer å’Œ Mamba...
      äº¤äº’æ¬¡æ•¸: 12
      äº‹å¯¦è¦†è“‹ç‡: 75%
      è€—æ™‚: 23.4s
      âœ… æˆåŠŸ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ é…ç½®: large-few
   æ¨¡å‹: gpt-4o
   æœ€å¤§äº¤äº’: 5 æ¬¡

   ğŸ”„ ä»»å‹™ 1/5: 2024 å¹´è«¾è²çˆ¾ç‰©ç†å­¸çå¾—ä¸»...
      äº¤äº’æ¬¡æ•¸: 3
      äº‹å¯¦è¦†è“‹ç‡: 100%
      è€—æ™‚: 8.1s
      âœ… æˆåŠŸ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ˆ å¯¦é©—çµæœæ¯”è¼ƒ
============================================================

| é…ç½® | æˆåŠŸç‡ | å¹³å‡äº¤äº’ | å¹³å‡è€—æ™‚ | äº‹å¯¦è¦†è“‹ç‡ | Token ä½¿ç”¨ |
|------|--------|----------|----------|------------|------------|
| small-many | 100% | 10.4 æ¬¡ | 18.7s | 87.5% | 12,450 |
| large-few | 100% | 3.8 æ¬¡ | 9.2s | 82.5% | 8,320 |

ğŸ” é—œéµç™¼ç¾ï¼š
1. å°æ¨¡å‹ + å¤šäº¤äº’çš„äº‹å¯¦è¦†è“‹ç‡ç•¥é«˜ï¼ˆ+5%ï¼‰
2. å¤§æ¨¡å‹çš„é€Ÿåº¦å„ªå‹¢æ˜é¡¯ï¼ˆ-50% è€—æ™‚ï¼‰
3. Token ä½¿ç”¨é‡å·®ç•°ä¸å¦‚é æœŸå¤§ï¼ˆ+50%ï¼‰

============================================================
â±ï¸ ç¸½å¯¦é©—æ™‚é–“: 234.5 ç§’
ğŸ“Š å ±å‘Šå·²ä¿å­˜è‡³: ./results/experiment_2024-01-08.md
```

---

## çµæœåˆ†æ

### è¼¸å‡ºæª”æ¡ˆ

å¯¦é©—å®Œæˆå¾Œæœƒç”Ÿæˆä»¥ä¸‹æª”æ¡ˆï¼š

```
results/
â”œâ”€â”€ experiment_2024-01-08.md      # Markdown æ ¼å¼å ±å‘Š
â”œâ”€â”€ experiment_2024-01-08.json    # JSON æ ¼å¼åŸå§‹æ•¸æ“š
â””â”€â”€ charts/
    â”œâ”€â”€ interaction_comparison.png  # äº¤äº’æ¬¡æ•¸æ¯”è¼ƒåœ–
    â”œâ”€â”€ accuracy_comparison.png     # æº–ç¢ºåº¦æ¯”è¼ƒåœ–
    â””â”€â”€ cost_analysis.png           # æˆæœ¬åˆ†æåœ–
```

### è§£è®€æŒ‡æ¨™

| æŒ‡æ¨™ | èªªæ˜ | ç†æƒ³å€¼ |
|------|------|--------|
| æˆåŠŸç‡ | æˆåŠŸå®Œæˆä»»å‹™çš„æ¯”ä¾‹ | 100% |
| å¹³å‡äº¤äº’æ¬¡æ•¸ | å®Œæˆä»»å‹™æ‰€éœ€çš„å·¥å…·èª¿ç”¨æ¬¡æ•¸ | è¦–ä»»å‹™è€Œå®š |
| äº‹å¯¦è¦†è“‹ç‡ | ç­”æ¡ˆåŒ…å«é æœŸäº‹å¯¦çš„æ¯”ä¾‹ | â‰¥80% |
| Token ä½¿ç”¨é‡ | ç¸½ Token æ¶ˆè€— | è¶Šä½è¶Šå¥½ |
| å¹³å‡è€—æ™‚ | å®Œæˆä»»å‹™çš„æ™‚é–“ | è¶ŠçŸ­è¶Šå¥½ |

---

## é€²éšç”¨æ³•

### è‡ªè¨‚ä»»å‹™é›†

```python
from scaling_experiment import Task, ScalingExperiment

# å®šç¾©è‡ªå·±çš„ä»»å‹™
my_tasks = [
    Task(
        id="custom_01",
        question="ä½ çš„ç ”ç©¶å•é¡Œ",
        difficulty="hard",
        expected_facts=["é—œéµäº‹å¯¦1", "é—œéµäº‹å¯¦2"]
    ),
    # æ›´å¤šä»»å‹™...
]

# åŸ·è¡Œå¯¦é©—
experiment = ScalingExperiment(tasks=my_tasks)
```

### è‡ªè¨‚è©•ä¼°å‡½æ•¸

```python
def custom_evaluator(answer: str, expected_facts: list[str]) -> float:
    """è‡ªè¨‚è©•ä¼°é‚è¼¯"""
    # ä½ çš„è©•ä¼°é‚è¼¯
    return score

experiment = ScalingExperiment(
    tasks=my_tasks,
    evaluator=custom_evaluator
)
```

### æ‰¹æ¬¡å¯¦é©—

```python
# å¤šç¨®é…ç½®çµ„åˆ
configs = [
    ExperimentConfig("mini-5", "gpt-4o-mini", 5),
    ExperimentConfig("mini-10", "gpt-4o-mini", 10),
    ExperimentConfig("mini-20", "gpt-4o-mini", 20),
    ExperimentConfig("4o-5", "gpt-4o", 5),
    ExperimentConfig("4o-10", "gpt-4o", 10),
]

results = experiment.run_all(configs)
experiment.generate_comparison_chart(results)
```

---

## å¸¸è¦‹å•é¡Œ

### Q: å¯¦é©—çµæœä¸ç©©å®šæ€éº¼è¾¦ï¼Ÿ

ç”±æ–¼ LLM çš„éš¨æ©Ÿæ€§ï¼Œæ¯æ¬¡åŸ·è¡Œçµæœå¯èƒ½ç•¥æœ‰ä¸åŒã€‚å»ºè­°ï¼š
1. é™ä½ `temperature` åƒæ•¸ï¼ˆå¦‚ 0.0ï¼‰
2. å¢åŠ å¯¦é©—é‡è¤‡æ¬¡æ•¸ï¼ˆä½¿ç”¨ `--repeat 3`ï¼‰
3. å–å¤šæ¬¡å¯¦é©—çš„å¹³å‡å€¼

### Q: API æˆæœ¬å¤ªé«˜æ€éº¼è¾¦ï¼Ÿ

1. å…ˆç”¨ `gpt-4o-mini` æ¸¬è©¦æµç¨‹
2. æ¸›å°‘ä»»å‹™æ•¸é‡ï¼ˆå¦‚åªç”¨ 3 å€‹ä»£è¡¨æ€§ä»»å‹™ï¼‰
3. å•Ÿç”¨å¿«å–é¿å…é‡è¤‡è«‹æ±‚

### Q: å¦‚ä½•æ·»åŠ æ–°çš„æœå°‹å·¥å…·ï¼Ÿ

ä¿®æ”¹ `scaling_experiment.py` ä¸­çš„ `SearchTool` é¡åˆ¥ï¼š

```python
class CustomSearchTool:
    def search(self, query: str) -> str:
        # ä½ çš„æœå°‹é‚è¼¯
        return results
```

---

## å»¶ä¼¸é–±è®€

- [ç¬¬ 1 ç« ç¨‹å¼ç¢¼](../chapter-01/) - ReAct ä»£ç†äººåŸºç¤
- [MiroThinker æŠ€è¡“å ±å‘Š](https://github.com/MiroMindAI/MiroThinker)
- [Scaling Laws ç›¸é—œè«–æ–‡](https://arxiv.org/abs/2001.08361)

---

**æœ¬ç« ç¨‹å¼ç¢¼æˆæ¬Š**ï¼šMIT License
