# 第13章　行動裝置上的軟體設計

> 「行動裝置不是縮小版的桌面，而是一個全新的情境。設計時要考慮：觸控、小螢幕、移動中使用、電池有限。」

---

## 13.1 行動裝置的特性

### 13.1.1 行動 vs. 桌面

| 面向 | 桌面 | 行動 |
|------|------|------|
| 螢幕 | 大（13-27 吋） | 小（4-7 吋） |
| 輸入 | 鍵盤、滑鼠 | 觸控、語音 |
| 網路 | 穩定 | 不穩定（3G/4G/WiFi） |
| 電池 | 無限 | 有限 |
| 情境 | 固定位置 | 移動中 |
| 注意力 | 專注 | 分散 |
| 感應器 | 少 | 多（GPS、陀螺儀、相機） |

### 13.1.2 行動裝置的限制

| 限制 | 影響 | 設計考量 |
|------|------|----------|
| **小螢幕** | 資訊呈現受限 | 簡化、優先級 |
| **觸控輸入** | 精確度低 | 大按鈕、足夠間距 |
| **網路不穩** | 連線中斷 | 離線支援、快取 |
| **電池有限** | 耗電敏感 | 減少背景處理 |
| **效能** | CPU/RAM 有限 | 優化、延遲載入 |

### 13.1.3 行動裝置的優勢

| 優勢 | 機會 |
|------|------|
| **隨身攜帶** | 隨時隨地使用 |
| **情境感知** | GPS、動作感應 |
| **相機** | 掃描、AR |
| **通知** | 即時提醒 |
| **生物辨識** | 指紋、Face ID |

---

## 13.2 行動 UI 設計原則

### 13.2.1 觸控優先

**觸控目標大小**：

| 平台 | 最小尺寸 | 建議尺寸 |
|------|----------|----------|
| iOS | 44 × 44 pt | 48 × 48 pt |
| Android | 48 × 48 dp | 56 × 56 dp |

**觸控考量**：
- 按鈕間距至少 8 dp
- 常用按鈕放在拇指可及範圍
- 避免需要精確點擊的操作

```
┌─────────────────────────────────────┐
│                                     │
│    難以觸及區域                      │
│    ┌───────────────────────┐       │
│    │                       │       │
│    │                       │       │
│    │                       │       │
│    │    主要內容區域        │       │
│    │                       │       │
│    │                       │       │
│    │                       │       │
│    └───────────────────────┘       │
│                                     │
│    ═══════════════════════════     │
│    拇指容易觸及（常用按鈕）          │
│                                     │
└─────────────────────────────────────┘
```

### 13.2.2 內容優先

**原則**：減少裝飾，聚焦內容。

| 做法 | 說明 |
|------|------|
| **簡化導航** | 只保留核心功能 |
| **漸進式揭露** | 隱藏次要資訊 |
| **減少輸入** | 預填、選擇優於輸入 |
| **一次做一件事** | 聚焦單一任務 |

### 13.2.3 效能優先

使用者對效能非常敏感：

| 指標 | 目標 |
|------|------|
| 首次顯示 | < 1 秒 |
| 可互動 | < 3 秒 |
| 回應觸控 | < 100 ms |

**優化策略**：

| 策略 | 做法 |
|------|------|
| **延遲載入** | 先載入可見內容 |
| **快取** | 減少網路請求 |
| **壓縮** | 圖片、資料壓縮 |
| **預取** | 預測使用者下一步 |

---

## 13.3 行動應用類型

### 13.3.1 三種應用類型

| 類型 | 技術 | 優點 | 缺點 |
|------|------|------|------|
| **原生應用** | Swift/Kotlin | 效能最佳、全功能 | 開發成本高 |
| **Web 應用** | HTML/CSS/JS | 跨平台、易更新 | 功能受限、效能差 |
| **混合應用** | React Native/Flutter | 跨平台、接近原生 | 效能折衷 |

### 13.3.2 選擇考量

| 考量 | 原生 | Web | 混合 |
|------|------|-----|------|
| 效能要求高 | ✅ | ❌ | ⚠️ |
| 跨平台 | ❌ | ✅ | ✅ |
| 硬體存取 | ✅ | ⚠️ | ✅ |
| 開發成本 | 高 | 低 | 中 |
| 更新速度 | 慢（需審核） | 快 | 中 |
| 離線支援 | ✅ | ⚠️ | ✅ |

### 13.3.3 PWA（Progressive Web App）

結合 Web 和原生的優點：

| 特性 | 說明 |
|------|------|
| **可安裝** | 加到主畫面 |
| **離線支援** | Service Worker 快取 |
| **推送通知** | Web Push API |
| **響應式** | 適應各種螢幕 |

---

## 13.4 行動應用架構

### 13.4.1 常見架構模式

**MVC（Model-View-Controller）**

```
┌─────────┐     ┌─────────────┐     ┌─────────┐
│  View   │◄────│ Controller  │────►│  Model  │
│  介面   │     │   控制器    │     │  資料   │
└─────────┘     └─────────────┘     └─────────┘
```

**MVVM（Model-View-ViewModel）**

```
┌─────────┐     ┌─────────────┐     ┌─────────┐
│  View   │◄───►│  ViewModel  │◄───►│  Model  │
│  介面   │     │   資料綁定   │     │  資料   │
└─────────┘     └─────────────┘     └─────────┘
```

**單向資料流**

```
┌─────────┐  Action  ┌─────────┐  State  ┌─────────┐
│  View   │─────────►│  Store  │────────►│  View   │
└─────────┘          └─────────┘         └─────────┘
```

### 13.4.2 離線優先架構

```
┌─────────────────────────────────────────────────┐
│                    App                          │
│                                                 │
│  ┌──────────┐    ┌──────────┐    ┌──────────┐ │
│  │    UI    │◄──►│  State   │◄──►│  Local   │ │
│  │          │    │ Manager  │    │   DB     │ │
│  └──────────┘    └────┬─────┘    └──────────┘ │
│                       │                        │
│                       ▼                        │
│                 ┌──────────┐                   │
│                 │   Sync   │                   │
│                 │  Manager │                   │
│                 └────┬─────┘                   │
└──────────────────────┼─────────────────────────┘
                       │
                       ▼
                 ┌──────────┐
                 │  Server  │
                 └──────────┘
```

**關鍵點**：
1. 本地資料庫為主
2. 網路可用時同步
3. 衝突解決策略

---

## 13.5 行動應用品質

### 13.5.1 效能優化

| 面向 | 技術 |
|------|------|
| **啟動時間** | 延遲初始化、Splash Screen |
| **渲染效能** | 虛擬列表、減少重繪 |
| **記憶體** | 及時釋放、圖片壓縮 |
| **電池** | 減少背景任務、批次處理 |
| **網路** | 快取、壓縮、預取 |

### 13.5.2 網路處理

**處理不穩定網路**：

| 策略 | 做法 |
|------|------|
| **離線快取** | 快取 API 回應 |
| **樂觀更新** | 先更新 UI，背景同步 |
| **重試機制** | 自動重試失敗請求 |
| **網路狀態** | 顯示離線/連線狀態 |
| **佇列** | 離線時佇列操作 |

### 13.5.3 安全考量

| 考量 | 做法 |
|------|------|
| **資料儲存** | 加密敏感資料 |
| **網路傳輸** | HTTPS、憑證釘選 |
| **認證** | OAuth、生物辨識 |
| **輸入驗證** | 防止注入攻擊 |
| **程式碼保護** | 混淆、防逆向 |

---

## 13.6 行動應用測試

### 13.6.1 測試類型

| 類型 | 說明 | 工具 |
|------|------|------|
| **單元測試** | 邏輯測試 | XCTest, JUnit |
| **UI 測試** | 介面自動化 | XCUITest, Espresso |
| **效能測試** | 啟動、渲染、記憶體 | Instruments, Profiler |
| **網路測試** | 弱網、離線 | Charles, 網路限速 |
| **真機測試** | 實際裝置 | Device Farm |

### 13.6.2 測試策略

```
                    ┌─────────────┐
                   ╱               ╲
                  ╱   真機測試      ╲
                 ╱   (少量關鍵路徑)  ╲
                ╱─────────────────────╲
               ╱                       ╲
              ╱     UI/整合測試         ╲
             ╱     (主要流程)            ╲
            ╱───────────────────────────╲
           ╱                             ╲
          ╱         單元測試              ╲
         ╱         (大量邏輯)              ╲
        ╱───────────────────────────────────╲
```

### 13.6.3 特殊測試情境

| 情境 | 測試內容 |
|------|----------|
| **弱網路** | 2G/3G 網路下的行為 |
| **無網路** | 離線時的行為 |
| **低電量** | 低電量模式下的行為 |
| **中斷** | 來電、通知中斷 |
| **背景** | App 進入背景的行為 |
| **旋轉** | 螢幕旋轉的處理 |

---

## 13.7 本章總結

### 核心概念

| 概念 | 一句話解釋 |
|------|-----------|
| 行動限制 | 小螢幕、觸控、網路不穩、電池有限 |
| 觸控優先 | 大按鈕（44-48pt）、拇指可及 |
| 內容優先 | 簡化、聚焦、漸進式揭露 |
| 離線優先 | 本地儲存、背景同步 |
| 效能優先 | 延遲載入、快取、壓縮 |

### 行動設計檢查清單

| 項目 | 問題 |
|------|------|
| 觸控目標 | 按鈕夠大嗎？（≥ 44pt） |
| 單手操作 | 常用功能在拇指可及範圍嗎？ |
| 離線支援 | 斷網時能用嗎？ |
| 效能 | 啟動快嗎？（< 3 秒） |
| 電池 | 會快速耗電嗎？ |
| 網路 | 弱網下能用嗎？ |

### 下一章預告

行動設計完成後，如何善用設計模式？下一章我們將學習「以樣式（Pattern）為基礎的設計」。

---

## 延伸思考

1. 你的應用支援離線嗎？如果不支援，需要嗎？

2. 你如何測試弱網路情境？

3. 原生 vs. 跨平台，你的團隊如何選擇？

---

*下一章：第14章　以樣式（Pattern）為基礎的設計*
