# 第2章　流程模型

> 「流程不是目的，而是達成目的的手段。選錯流程，就像用釘槍蓋紙屋。」

---

## 2.1 流程的本質：為什麼需要流程？

在上一章，我們談到軟體的本質困難：複雜性、可變性、不可見性。面對這些困難，我們需要一套「遊戲規則」來組織工作。這套遊戲規則就是「流程」。

### 流程回答的核心問題

任何流程模型都試圖回答以下問題：

1. **做什麼？**（What）—— 要交付哪些產物？
2. **何時做？**（When）—— 各活動的順序與時機？
3. **誰來做？**（Who）—— 角色與責任分配？
4. **怎麼做？**（How）—— 方法、工具、標準？
5. **怎麼知道做對了？**（How to verify）—— 驗證與品質關卡？

### 流程的價值

好的流程提供：

| 價值 | 說明 |
|------|------|
| **可預測性** | 知道下一步該做什麼，減少混亂 |
| **可重複性** | 成功經驗可以複製，不依賴英雄 |
| **可追溯性** | 出問題時能回溯原因 |
| **可改進性** | 有明確的流程才能度量和改進 |
| **溝通基礎** | 團隊有共同語言和期望 |

### 流程的陷阱

但流程也有危險：

| 陷阱 | 症狀 |
|------|------|
| **流程崇拜** | 遵守流程變成目的，忘了交付價值 |
| **過度流程** | 文件比程式碼多，會議比寫程式多 |
| **流程僵化** | 情境變了，流程不變 |
| **形式主義** | 有流程的形式，沒有流程的精神 |

**關鍵洞察**：流程是工具，不是宗教。選擇流程要看情境，而非教條。

---

## 2.2 流程框架：所有模型的共同骨架

不管是瀑布、敏捷、還是 DevOps，所有流程模型都包含這五個基本活動：

```
┌─────────────────────────────────────────────────────────────┐
│                      通用流程框架                            │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌─────────┐    ┌─────────┐    ┌─────────┐                │
│   │  溝通   │ →  │  規劃   │ →  │  建模   │                │
│   │Communication│ │Planning │    │Modeling │                │
│   └─────────┘    └─────────┘    └─────────┘                │
│        │              │              │                      │
│        ▼              ▼              ▼                      │
│   ┌─────────┐    ┌─────────┐                               │
│   │  建構   │ →  │  部署   │                               │
│   │Construction│ │Deployment│                               │
│   └─────────┘    └─────────┘                               │
│                                                             │
│   ════════════════════════════════════════                 │
│   傘型活動（Umbrella Activities）：                         │
│   追蹤、風險管理、品質保證、配置管理、審查、度量            │
└─────────────────────────────────────────────────────────────┘
```

### 五個核心活動

**1. 溝通（Communication）**
- 與利害關係人互動
- 理解目標、蒐集需求
- 產物：需求文件、用戶故事、溝通記錄

**2. 規劃（Planning）**
- 定義工作範圍
- 估算資源、時程、風險
- 產物：專案計畫、時程表、風險清單

**3. 建模（Modeling）**
- 分析需求、設計解決方案
- 產物：需求模型、架構設計、詳細設計

**4. 建構（Construction）**
- 編寫程式碼、測試
- 產物：可執行的軟體、測試報告

**5. 部署（Deployment）**
- 交付給使用者
- 收集回饋、提供支援
- 產物：上線的系統、使用文件、回饋報告

### 傘型活動

貫穿整個流程的支援活動：
- **追蹤與控制**：監控進度、調整計畫
- **風險管理**：識別、評估、緩解風險
- **品質保證**：審查、測試、驗證
- **配置管理**：版本控制、變更管理
- **度量與分析**：收集數據、改進流程

---

## 2.3 瀑布模型：最古老的模型

### 模型描述

瀑布模型（Waterfall Model）是最早被正式定義的流程模型，由 Winston Royce 在 1970 年提出。

```
需求分析
    ↓
  設計
    ↓
  實作
    ↓
  測試
    ↓
  維護
```

每個階段完成後才進入下一個階段，像瀑布一樣單向流動。

### 核心假設

瀑布模型基於以下假設：
1. 需求可以在開始時完全確定
2. 設計可以在編碼前完成
3. 錯誤可以在測試階段發現並修復
4. 各階段可以順序執行，不需回溯

### 優點

| 優點 | 說明 |
|------|------|
| 結構清晰 | 階段分明，易於管理 |
| 文件完整 | 每階段產出明確文件 |
| 便於追蹤 | 進度容易度量 |
| 適合外包 | 清晰的交付物和里程碑 |

### 缺點

| 缺點 | 說明 |
|------|------|
| 回饋太晚 | 直到測試階段才發現問題 |
| 變更困難 | 需求變更成本極高 |
| 風險後移 | 整合問題在最後才暴露 |
| 不適應不確定性 | 假設需求穩定，現實往往不是 |

### 適用情境

瀑布模型適用於：
- ✅ 需求非常穩定、明確（如嵌入式系統、合規系統）
- ✅ 技術成熟、風險低
- ✅ 有嚴格的文件要求（如醫療、航空）
- ✅ 分散團隊需要明確的交付物
- ❌ 需求不明確或會變化
- ❌ 需要快速回饋的創新專案

---

## 2.4 增量模型：分批交付

### 模型描述

增量模型（Incremental Model）將系統分成多個增量，每個增量是一個可運作的子系統。

```
增量 1：核心功能
    需求 → 設計 → 實作 → 測試 → 交付
                                    ↓
增量 2：擴展功能 A                  使用者開始使用
    需求 → 設計 → 實作 → 測試 → 交付
                                    ↓
增量 3：擴展功能 B                  回饋
    需求 → 設計 → 實作 → 測試 → 交付
```

### 核心思想

- 先交付核心功能，再逐步增加
- 每個增量都是可運作的產品
- 使用者提早獲得價值
- 可以根據回饋調整後續增量

### 優點

| 優點 | 說明 |
|------|------|
| 提早交付價值 | 核心功能先上線 |
| 風險分散 | 問題在小範圍內發現 |
| 回饋更早 | 使用者可以提早試用 |
| 彈性調整 | 後續增量可以根據回饋調整 |

### 缺點

| 缺點 | 說明 |
|------|------|
| 需要好的架構 | 必須預先設計可擴展的架構 |
| 整合挑戰 | 增量之間的整合需要仔細規劃 |
| 可能過度設計 | 為了「未來的增量」而過度設計 |

### 適用情境

- ✅ 核心需求明確，擴展需求可能變化
- ✅ 希望提早交付部分價值
- ✅ 有經驗的團隊可以規劃架構
- ❌ 所有功能必須同時上線
- ❌ 團隊缺乏架構規劃能力

---

## 2.5 演化模型：擁抱變化

演化模型（Evolutionary Model）認為軟體是「演化」出來的，而非「建造」出來的。

### 2.5.1 原型法（Prototyping）

**核心思想**：先做一個原型，讓使用者看到、試用，再根據回饋改進。

```
快速原型
    ↓
使用者評估
    ↓
  回饋
    ↓
改進原型（重複）
    ↓
最終產品
```

**兩種原型**：

| 類型 | 說明 | 處理方式 |
|------|------|----------|
| 拋棄式原型 | 只為驗證概念，不在乎品質 | 驗證後丟掉，重新開發 |
| 演化式原型 | 原型逐步演化成最終產品 | 持續改進，變成產品 |

**優點**：
- 快速驗證需求
- 降低誤解風險
- 使用者參與感強

**缺點**：
- 拋棄式原型容易被「留下來用」
- 演化式原型容易積累技術債
- 使用者可能對「快速原型」有過高期望

### 2.5.2 螺旋模型（Spiral Model）

由 Barry Boehm 在 1986 年提出，結合瀑布的系統化和原型的迭代。

```
                    規劃
                   ╱    ╲
                  ╱      ╲
           風險分析        客戶評估
                  ╲      ╱
                   ╲    ╱
                   開發/驗證

        （每圈螺旋是一次迭代）
```

**四個象限**：
1. **規劃**：定義目標、限制、替代方案
2. **風險分析**：識別和分析風險，決定是否繼續
3. **開發與驗證**：根據風險選擇開發方式（原型、瀑布、增量）
4. **客戶評估**：客戶審查，確認下一步

**核心特色**：
- **風險驅動**：每次迭代都要分析風險
- **靈活選擇**：根據風險決定開發方式
- **持續驗證**：每圈結束都有客戶評估

**優點**：
- 風險管理內建在流程中
- 靈活適應不同情境
- 適合大型、高風險專案

**缺點**：
- 需要豐富的風險分析經驗
- 管理複雜
- 小專案可能過度

---

## 2.6 並行模型：多線程開發

### 並行開發模型（Concurrent Development Model）

在現實中，各活動往往是並行進行的，而非嚴格順序。

```
溝通 ════════════════════════════════►
規劃 ════════════════════════════════►
建模     ══════════════════════►
建構         ══════════════════════►
部署              ═══════════════════►

      時間 ──────────────────────────►
```

**特點**：
- 活動可以重疊
- 根據情況調整每個活動的強度
- 適合長期專案

### 統一流程（Unified Process / RUP）

由 Rational 公司開發，結合增量、迭代、並行的模型。

**四個階段**：

| 階段 | 目標 | 主要活動 |
|------|------|----------|
| **初始**（Inception） | 確定專案可行性 | 願景、範圍、風險 |
| **精煉**（Elaboration） | 建立架構基線 | 架構設計、風險降低 |
| **建構**（Construction） | 開發可運作系統 | 編碼、測試、整合 |
| **轉移**（Transition） | 交付給使用者 | 部署、培訓、支援 |

**核心實踐**：
- 用例驅動（Use-case driven）
- 架構為中心（Architecture-centric）
- 迭代與增量（Iterative and incremental）

---

## 2.7 流程模型選擇矩陣

沒有「最佳」流程，只有「最適」流程。選擇取決於情境。

### 選擇維度

| 維度 | 瀑布 | 增量 | 原型 | 螺旋 | 敏捷 |
|------|------|------|------|------|------|
| 需求穩定性 | 高 | 中 | 低 | 低 | 低 |
| 技術風險 | 低 | 中 | 中 | 高 | 中 |
| 專案規模 | 任意 | 大 | 小-中 | 大 | 小-中 |
| 團隊規模 | 任意 | 大 | 小 | 大 | 小 |
| 回饋需求 | 低 | 中 | 高 | 高 | 高 |
| 文件要求 | 高 | 高 | 低 | 高 | 低 |
| 合規要求 | 高 | 高 | 低 | 高 | 低 |

### 決策樹

```
需求是否穩定？
├── 是 → 技術風險高？
│        ├── 是 → 螺旋模型
│        └── 否 → 瀑布或增量
└── 否 → 需要快速回饋？
         ├── 是 → 原型或敏捷
         └── 否 → 增量或演化
```

---

## 2.8 本章總結

### 核心概念

| 概念 | 一句話解釋 |
|------|-----------|
| 流程的價值 | 可預測、可重複、可追溯、可改進 |
| 流程的陷阱 | 流程崇拜、過度流程、僵化、形式主義 |
| 瀑布模型 | 順序執行，適合穩定需求 |
| 增量模型 | 分批交付，提早獲得價值 |
| 演化模型 | 擁抱變化，通過迭代演進 |
| 螺旋模型 | 風險驅動，每次迭代分析風險 |

### 關鍵決策

選擇流程時問自己：
1. 需求有多穩定？
2. 技術風險有多高？
3. 多快需要回饋？
4. 有什麼合規/文件要求？
5. 團隊的經驗和能力如何？

### 下一章預告

流程模型提供了骨架，但「敏捷」徹底改變了我們對流程的思考方式。下一章我們將深入探討：敏捷的本質是什麼？為什麼敏捷不是「沒有流程」？如何正確實踐敏捷？

---

## 延伸思考

1. 你目前的團隊使用什麼流程？它適合你們的情境嗎？

2. 如果讓你選擇，你會用什麼流程來開發一個全新的產品？一個遺留系統的重構？

3. 「混合流程」（如 Wagile = Waterfall + Agile）是好主意還是壞主意？

---

*下一章：第3章　敏捷與流程*
